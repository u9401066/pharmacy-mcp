# Decision Log

## 決策記錄

### DEC-001: 使用 MCP Python SDK
**日期**: 2025-12-22
**決策**: 使用官方 `mcp` Python SDK
**原因**: 
- 官方支援，穩定性高
- 與 Claude 整合最佳
- 持續更新維護

### DEC-002: 採用 DDD 分層架構
**日期**: 2025-12-22
**決策**: 使用 Domain-Driven Design 分層
**原因**:
- 業務邏輯與基礎設施分離
- 易於測試和維護
- 符合模板規範

### DEC-003: HTTP Client 選擇 httpx
**日期**: 2025-12-22
**決策**: 使用 httpx 而非 requests
**原因**:
- 原生支援 async/await
- API 與 requests 相容
- 效能較佳

### DEC-004: 快取選擇 diskcache
**日期**: 2025-12-22
**決策**: 使用 diskcache 而非 Redis
**原因**:
- 無需額外服務
- 適合單機部署
- 簡單易用

### DEC-005: 資料來源優先序
**日期**: 2025-12-22
**決策**: RxNorm > openFDA > DailyMed
**原因**:
- RxNorm 提供標準化藥品命名
- openFDA 提供不良反應資料
- DailyMed 提供完整仿單

### DEC-006: 本地藥物交互作用資料庫
**日期**: 2025-12-22
**決策**: 新增本地藥物交互作用資料庫作為備用
**原因**:
- RxNorm Drug Interaction API 於 2025 年被 NLM 停用
- 確保 MCP Tools 仍能提供基本的藥物交互作用檢查
- 本地資料庫包含 25+ 種臨床常見的高風險交互作用
- 結合 FDA 標籤資訊提供更完整的資料
**後續行動**:
- 尋找替代的外部 API（如 DrugBank API）
- 持續擴充本地資料庫

### DEC-007: 台灣藥品資料不自建資料庫
**日期**: 2025-12-22
**決策**: 使用政府開放資料 + disk cache，不建立獨立資料庫
**原因**:
- 政府開放資料每週更新，保持資料新鮮度
- 減少維護成本
- disk cache 提供 7 天 TTL，平衡效能與即時性
**資料來源**:
- TFDA: https://data.fda.gov.tw/opendata/exportDataList.do
- 政府資料開放平台: data.gov.tw/dataset/9122

### DEC-008: 健保給付規則使用本地資料庫
**日期**: 2025-12-22
**決策**: 手動維護健保給付規則資料庫
**原因**:
- 健保署無提供公開 API
- 給付規定變動頻率較低
- 可針對臨床常用藥品優先建立
**涵蓋範圍**: 60+ 藥品，11 類別

### DEC-009: DrugInfoService 自動整合台灣資訊
**日期**: 2025-12-22
**決策**: `get_full_info()` 回傳結果自動包含 `taiwan` 欄位
**原因**:
- 使用者無需額外呼叫即可獲得本地化資訊
- 台灣資訊作為補充，不影響原有 API 結構
- 當藥品有對應資料時才顯示，無則為 null

---
*Last updated: 2025-12-22*
